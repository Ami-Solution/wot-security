<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <link rel="stylesheet" href="tablestyle.css">
    <meta charset="utf-8" />
    <title>Web of Things (WoT) Security and Privacy Considerations</title>
    <script class="remove" async="" src="https://www.w3.org/Tools/respec/respec-w3c-common"></script>
    <script class="remove">
          var respecConfig = {
              specStatus:     "ED"
            , noRecTrack:     "true"
            , processVersion: 2017
            , shortName:      "wot-security"
            , copyrightStart: 2017
            , wg:             "Web of Things Working Group"
            , wgURI:          "http://www.w3.org/WoT/WG/"
            , wgPublicList:   "public-wot-wg"
            , edDraftURI:     "https://w3c.github.io/wot-security/"
            , githubAPI:      "https://api.github.com/repos/w3c/wot-security"
            , issueBase:      "https://www.github.com/w3c/wot-security/issues"
            , editors: [
                {
                  name:       "Elena Reshetova"
                , w3cid:      "xxxxx"
                , company:    "Intel Corp."
                , companyURL: "https://www.intel.com/"
                },
                {
                  name:       "Michael McCool"
                , w3cid:      "xxxxx"
                , company:    "Intel Corp."
                , companyURL: "https://www.intel.com/"
                }
              ]
            , otherLinks: [
                {
                  key: "Contributors"
                , data: [
                    {
                      value: "In the GitHub repository"
                    , href: "https://github.com/w3c/wot-security/graphs/contributors"
                    }
                  ]
                }
              , {
                  key: "Repository",
                  data: [
                    {
                      value: "We are on GitHub",
                      href: "https://github.com/w3c/wot-security/"
                    }
                  , {
                      value: "File a bug",
                      href: "https://github.com/w3c/wot-security/issues"
                    }
                  , {
                      value: "Contribute",
                      href: "https://github.com/w3c/wot-security/pulls"
                    }
                  ]
                }
              ]
            , localBiblio: {
                "CoRE-RD": {
                  href: "https://tools.ietf.org/html/draft-ietf-core-resource-directory-11"
                , title: "CoRE Resource Directory"
                , status:    "Internet-Draft"
                , publisher: "IETF"
                , date: "03 July 2017"
                },
                "Ocf17": {
                  href: "https://openconnectivity.org/specs/OCF_Security_Specification_v1.0.0.pdf"
                , title: "The OCF Security Specification, version 1.0.0"
                , publisher: "OCF"
                , date: "June 2017"
                },
                "JWT15": {
                  href: "https://tools.ietf.org/html/rfc7519"
                , title: "JSON Web Token (JWT)"
                , publisher: "IETF"
                , date: "May 2015"
                },
                "CBOR17": {
                  href: "https://tools.ietf.org/pdf/draft-ietf-ace-cbor-web-token-07.pdf"
                , title: "CBOR Web Token (CWT)"
                , status:    "Internet-Draft"
                , publisher: "IETF"
                , date: "June 2017"
                },
                "OSCOAP17": {
                  href: "https://tools.ietf.org/pdf/draft-ietf-core-object-security-04.pdf"
                , title: "Object Security of CoAP (OSCOAP)"
                , status:    "Internet-Draft"
                , publisher: "IETF"
                , date: "July 2017"
                },
                "Bel89": {
                  authors: ["S. Bellovin"]
                , href: "https://cseweb.ucsd.edu/classes/sp99/cse227/ipext.pdf"
                , title: "Security Problems in the TCP-IP Protocol Suite"
                , publisher: "Computer Communication Review, Vol. 19, No. 2" 
                , pages: "32-48"
                , date: "April 1989"
                },
                "Bel13": {
                  authors: ["S. Bellovin"]
                  , href: "http://csrc.nist.gov/groups/ST/ca-workshop-2013/presentations/Bellovin_ca-workshop2013.pdf"
 
                  , title: "Web Security in the Real World" 
                  , publisher: "Workshop on Improving Trust in the Online Marketplace, NIST" 
                  , date: "April 2013"
                },
                "Ber14": {
                  authors: ["V. Bertocci"]
                  , href: "http://www.cloudidentity.com/blog/2014/04/22/authentication-protocols-web-ux-and-web-api/"
                  , title: "Authentication Protocols, Web UX and Web API" 
                  , date: "April 2014"
                },
                "Bor14": {
                  authors: ["C. Bormann", "et al."]
                  , href: "https://tools.ietf.org/rfc/rfc7228.txt"
                  , title: "Terminology for Constrained-Node Networks"
                  , publisher: "IETF RFC 7228"
                  , date: "May 2014"
                },
                "Bru14": {
                  authors: ["C. Brubaker", "et al."]
                  , href: "https://www.cs.utexas.edu/~shmat/shmat_oak14.pdf"
                  , title: "Using Frankencerts for Automated Adversarial Testing of Certificate Validation in SSL/TLS Implementations"
                  , publisher: "IEEE Security Privacy"
                  , date: "2014"
                  , pages: "114-129"
                },
                "Coo13": {
                  authors: ["A. Cooper", "et al"]
                  , href: "https://tools.ietf.org/html/rfc6973"
                  , title: "Privacy Considerations for Internet Protocols"
                  , publisher: "IETF RFC 6973 (IAB Guideline)"
                  , date: "July 2013"
                },
                "Dur13": {
                  authors: ["Z. Durumeric", "et al."]
                  , href: "http://conferences.sigcomm.org/imc/2013/papers/imc257-durumericAemb.pdf"
                  , title: "Analysis of the HTTPS Certificate Ecosystem"
                  , publisher: "Proc. of the 2013 conference on Internet measurement conference"
                  , date: "October 2013"
                },
                "Ell00": {
                  authors: ["C. Ellison", "B. Schneier"]
                  , href: "https://www.schneier.com/paper-pki.pdf"
                  , title: "Ten Risks of PKI: What You’re not Being Told about Public Key Infrastructure"
                  , publisher: "Computer Security Journal, v 16, n 1,"
                  , date: "2000"
                  , pages: "1-7"
                },
                "Fu01": {
                  authors: ["K. Fu", "et al."]
                  , href: "http://pdos.csail.mit.edu/papers/webauth:sec10.pdf"
                  , title: "Dos and Don’ts of Client Authentication on the Web"
                  , publisher: "Proc. 10th USENIX Security Symposium"
                  , date: "August 2001"
                },
                "Geo12": {
                  authors: ["M. Georgiev", "et al."]
                  , href: "http://www.cs.utexas.edu/~shmat/shmat_ccs12.pdf"
                  , title: "The Most Dangerous Code in the World: Validating SSL Certificates in Non-Browser Software"
                  , publisher: "Proc. of the 2012 ACM conference on Computer and communications security"
                  , date: "2012"
                  , pages: "38-49"
                },
                "Gol03": {
                  authors: ["O. Goldreich"]
                  , href: "http://www.wisdom.weizmann.ac.il/~oded/foc-sur01.html"
                  , title: "Cryptography and Cryptographic Protocols"
                  , publisher: "Distributed Computing, vol. 16"
                  , pages: "177-199"
                  , date: "2003"
                }, 
                "Gre14": {
                  authors: ["M. Green"]
                  , href: "http://blog.cryptographyengineering.com/2014/03/how-do-you-know-if-rng-is-working.html"
                  , title: "How do you know if an RNG is working?"
                  , date: "March 2014"
                },
                "Gut02": {
                  authors: ["P. Gutman"]
                  , href: "https://www.cs.auckland.ac.nz/~pgut001/pubs/notdead.pdf"
                  , title: "PKI: It’s Not Dead, Just Resting"
                  , publisher: "IEEE Computer, vol. 35, no. 8"
                  , date: "Aug. 2002"
                  , pages: "41-49"
                },
                "Hea13": {
                  authors: ["M. Hearn"]
                  , href: "http://googleblog.blogspot.de/2013/02/an-update-on-our-war-against-account.html"
                  , title: "An update on our war against account hijackers"
                  , date: "Feb 2013"
                },
                "IETFACE": {
                  title: "IETF Authentication and Authorization for Constrained Environments (ACE)"
                  , href: "https://tools.ietf.org/wg/ace/"
                },
                "Iic15": {
                  authors: ["Industrial Internet Consortium"]
                  , href: "http://www.iiconsortium.org/IIRA.htm"
                  , title: "Industrial Internet Reference Architecture"
                  , date: "June 2015"
                },
                "IicRA17": {
                  authors: ["Industrial Internet Consortium"]
                  , href: "http://www.iiconsortium.org/IIRA.htm"
                  , title: "The Industrial Internet of Things Volume G1: Reference Architecture"
                  , publisher: "IIC:PUB:G1:V1.80:20170131"
                  , date: "Jan 2017"
                },
                "IicSF16": {
                  authors: ["Industrial Internet Consortium"]
                  , href: "http://www.iiconsortium.org/IISF.htm"
                  , title: "The Industrial Internet of Things Volume G4: Security Framework"
                  , publisher: "IIC:PUB:G4:V1.0:PB:20160926"
                  , date: "Sept 2016"
                },
                "ISF17": {
                  authors: ["IoT Security Foundation"]
                  , href: "https://iotsecurityfoundation.org/best-practice-guidelines/"
                  , title: "IoT Security Foundation Best Practice Guidelines"
                  , date: "May 2017"
                },
                "Jon14": {
                  authors: ["M. Jones"]
                  , href: "http://www.niso.org/apps/group<em>public/download.php/14003/SPJonesJSONisqv26no3.pdf"
                  , title: "A JSON-Based Identity Protocol Suite"
                  , publisher: "Information Standards Quarterly, vol. 26, no. 3"
                  , date: "2014"
                  , pages: "19–22"
                },
                "Ken03": {
                  authors: ["S. Kent", "L. Millet"]
                  , href: "http://www.nap.edu/openbook.php?isbn=0309088968"
                  , title: "Who Goes There? Authentication Through the Lens of Privacy"
                  , publisher: "The National Academies Press, Washington D.C."
                  , date: "2003"
                },
                "Lam04": {
                  authors: ["B. Lampson"]
                  , href: "http://research.microsoft.com/en-us/um/people/blampson/69-SecurityRealIEEE/69-SecurityRealIEEE.htm"
                  , title: "Computer Security in the Real World"
                  , publisher: "IEEE Computer, vol. 37, no. 6"
                  , date: "June 2004"
                  , pages: "37-46"
                },
                "Loc05": {
                  authors: ["H. Lockhart"]
                  , href: "http://www.oracle.com/au/products/database/saml-084342.html"
                  , title: "Demystifying SAML"
                  , date: "May 2005"
                },
                "Mel15": {
                  authors: ["D. Melzer"]
                  , href: "http://c.ymcdn.com/sites/www.issa.org/resource/resmgr/journalpdfs/feature0615.pdf"
                  , title: "Securing the Industrial Internet of Things"
                  , date: "June 2015"
                },
                "Mic17": {
                  authors: ["Microsoft"]
                  , href: "https://docs.microsoft.com/en-us/azure/iot-suite/iot-security-architecture"
                  , title: "Internet of Things security architecture"
                  , publisher: "STRIDE threat model for IoT"
                  , date: "Jan 2017"
                },
                "Moo02": {
                  authors: ["T. Moors"]
                  , href: "http://www.csd.uoc.gr/~hy435/material/moors.pdf"
                  , title: "A critical review of End-to-end arguments in system design"
                  , publisher: "Proc. of the IEEE International Conference on Communications"
                  , date: "2002"
                },
                "Nis15": {
                  authors: ["NIST"] 
                  , title: "Guide to Industrial Control Systems (ICS) Security"
                  , publisher: "NIST Special Publication 800-82"
                },
                "Oos10": {
                  authors: ["M. Oosdijk", "et al."]
                  , href: "https://tnc2011.terena.org/getfile/696"
                  , title: "Provisioning scenarios in identity federations"
                  , publisher: "Surfnet Research Paper" 
                  , date: "2010"
                },
                "Owa17": {
                  authors: ["OWASP"]
                  , href: "https://www.owasp.org/index.php/ThreatRiskModeling"
                  , title: "Threat Risk Modeling"
                  , publisher: "OWASP"
                  , date: "Jan 2017"
                },
                "Res03": {
                  authors: ["E. Rescorla", "et al."]
                  , href: "https://tools.ietf.org/html/rfc3552"
                  , title: "Guidelines for Writing RFC Text on Security Considerations"
                  , publisher: "IETF RFC 3552 (IAB Guideline)"
                  , date: "2003"
                },
                "Sch14": {
                  authors: ["B. Schneier"]
                  , href: "http://www.wired.com/2014/01/theres-no-good-way-to-patch-the-internet-of-things-and-thats-a-huge-problem/"
                  , title: "The Internet of Things Is Wildly Insecure — And Often Unpatchable"
                  , publisher: "Wired"
                  , date: "Jan. 2014"
                },
                "Sch99": {
                  authors: ["B. Scheier", "A. Shostack"]
                  , href: "https://www.schneier.com/paper-smart-card-threats.pdf"
                  , title: "Breaking Up Is Hard To Do: Modeling Security Threats for Smart Cards"
                  , publisher: "USENIX Workshop on Smart Card Technology, USENIX Press"
                  , date: "1999"
                  , pages: "175-185"
                },
                "She14": {
                  authors: ["Z. Shelby", "et al."]
                  , href: "https://tools.ietf.org/rfc/rfc7252.txt"
                  , title: "The Constrained Application Protocol (CoAP)"
                  , publisher: "IETF RFC 7252"
                  , date: "June 2014"
                 },
                "Vol00": {
                  authors: ["J. Vollbrecht", "et al."]
                  , href: "https://tools.ietf.org/rfc/rfc2904.txt"
                  , title: "AAA Authorization Framework"
                  , publisher: "IETF RFC 2904"
                  , date: "Aug. 2000"
                },
                "Yeg11": {
                  authors: ["S. Yegge"]
                  , href: "https://plus.google.com/+RipRowan/posts/eVeouesvaVX"
                  , title: "Stevey's Google Platforms Rant"
                  , publisher: "Blog"
                  , date: "Oct. 2011"
                }
              }
            };
    </script>
  </head>
  <body>
    <section id="abstract">
     <p>
     This document provides non-normative guidance on Web of Things (WoT) security and privacy.
     The Web of Things is descriptive, not prescriptive, 
     and so is generally designed to support the security models and mechanisms of the systems it describes,
     not introduce new ones.
     However, a WoT system also has its own unique assets, such as a Scripting API and Thing Descriptions, that
     need to be protected and also have security and privacy implications.
     </p><p>
     We define the general security requirements for a Web of Things system using a threat model.
     The WoT threat model defines the main security stakeholders, security-relevant assets, possible attackers, attack surfaces, 
     and finally threats for a WoT system.
     Using this generic WoT threat model as a foundation, 
     it should be possible to build a specific set of security objectives for a concrete WoT system implementation.
     We provide several examples using common scenarios based on home, enterprise, and industrial use cases.
     We also provide more general guidance on the design and deployment of a secure WoT system.
     All recommendations are linked to the corresponding WoT threats in the generic woT threat model in order to 
     facilitate understanding why they are needed. 
     </p><p>
     It is not the intention of this document to limit the set of security mechanisms that can be used to 
     secure a WoT network.  
     In particular, while we provide examples and recommendations based on the best available practices in the industry,
     this document contains informative statements only.
     Specific normative security aspects of the WoT specification are defined in the corresponding normative WoT documents
     for each WoT building block.
     </p>
     <p class="ednote">
        Check that content is consistent with the summary in the 
        Security sections of other documents, in particular the
	<a href="https://w3c.github.io/wot-architecture#x8.-security-and-privacy-considerations">WoT Architecture</a> 
        document.
     </p>
    </section>

    <section id="sotd">
      <p class="ednote" title="The W3C WoT WG is asking for feedback">
        Please contribute to this draft using the <a href="https://github.com/w3c/wot-security/issues">GitHub Issue</a> feature of the <a href="https://github.com/w3c/wot-security/">WoT Security and Privacy Considerations</a> repository.
      </p>
    </section>

    <section>
      <h1>Introduction</h1>
      <p>Security of a WoT system can refer to the security of the Thing Description itself or the security of the Thing the Thing Description describes.
      See also:
      <ul>
        <li>the <a href="https://www.w3.org/WoT/IG/">Interest Group</a> web site</li>
        <li>the <a href="https://www.w3.org/WoT/WG/">Working Group</a> web site</li>
        <li>the <a href="https://w3c.github.io/wot-thing-description/">WoT Thing Description</a>,</li>
        <li>the <a href="https://w3c.github.io/wot-binding-templates/">WoT Binding Templates</a>, and</li>
        <li>the <a href="https://w3c.github.io/wot-scripting-api/">WoT Scripting API</a>.</li>
      </ul>
      </p>
    </section>

  <section>
    <h1>Requirements</h1>
	
        <section>
        <h2>General</h2>
            <p>
            In general using the WoT approach should "do no harm": the security of any protocols should be maintained.
		        The Web of Things systems does not introduce new security mechanisms, 
            but should preserve the functionality of existing mechanisms.
            <ul>
                <li><strong>Exposing:</strong>
                When exposing a TD, especially via the Scripting API,
                it should be possible to use best practices for security,
                including maintaining the integrity of the TD and delivering it only to an authorized recipient.</li>
                <li><strong>Consuming:</strong>
		            A consumed TD should accurately reflect the actual security status of a target device.</li>
                <li><strong>Protocols:</strong>
		            We will ensure in particular that, at a minimum, 
                the needs of the following protocols are addressed: http(s) and coap(s).</li>
            </ul>
            </p>
        </section>

        <section id="wot-threat-model">
        <h2>Threat Model</h2>
            <p> 
              Due to the large diversity of devices, use cases, country regulations and requirements for WoT Things,
              it is impossible to define a single WoT threat model that would fit every case.
              Instead we have created an overall WoT threat model framework that can be adjusted
              by OEMs or other WoT system users or providers based on their concrete security requirements.
            </p>
            <section id="wot-threat-model-stakeholders">
            <h3>WoT Primary Stakeholders</h3>
                <p>This section lists the primary WoT stakeholders.</p>
		<table>
		    <tr>
			<th>Stakeholder</th>
			<th>Description</th>
                        <!-- TODO: remove "business-driven"? may not be a business user -->
			<th>Business-driven security goals</th>
                        <!-- TODO: remove "interesting"? redundant. -->
			<th>Interesting edge cases</th>
		    </tr><tr>
			<th><dfn data-lt="thing manufacturer|thing manufacturers|manufacturer|oem">
                            Thing Manufacturer</dfn> (OEM)</th>
			<td>Producer of the HW thing,
                            might define and make TD available for everyone,
                            implements WoT runtime,
                            certifies thing to be WoT compliant.</td>
                        <td>Don't want the things to be used in any form of attacks
                            (loss of reputation, possible legal consequences in some countries).
                            Want to satisfy security requirements of solution users 
                            and solution providers for better sales.</td>
			<td></td>
		    </tr><tr>
                        <!-- TODO: should we just have one term here?  Are these different or the same? -->
                        <!-- TODO: should we use "Thing" or "Solution" more consistently?  Maybe some other
                             prefix like "WoT"? -->
			<th><dfn data-lt="solution provider|solution providers">
                            Solution Provider</dfn><br/> or
                            <dfn data-lt="solution integrator|solution integrators">
                            Solution Integrator</dfn>
                        </th>
			<td>Uses things from OEMs to build various WoT end solutions
                            specific to particular WoT use case(s).
                            An <a>OEM</a> might simultaneously be a solution provider.
                            Might define new TDs for things or modify TDs provided by manufacturers.
                            Might use scripting API and runtime provided to implement their solution
                            or might do a full reflash of the thing.
                            Solution provider's scripts and their configuration data might require 
                            confidentiality and/or integrity.
                            A solution integrator is similar to a solution provider but tends to
                            reuse rather than create new technology.
                        </td>
			<td>Don't want their solution to be a target of attacks
                            (loss of reputation, possible legal consequences in some countries).
                            Want to satisfy security requirements of solution users for better sales.
                            Don't want security to interfere with usability for better sales
                            (usability vs. security). 
                            <!-- Is "DOS resistance" a defined term?  If so, where are they defined, and do we 
                                 need links? -->
                            Want solution to be robust and not easily falling down to DoS
                            (at least basic DoS resistance).
                            Want to hide their proprietary scripts and other relevant data from other parties.
                            <!-- TODO Are there any security obligations towards OEMs? -->
                            </td>
			<td>There might be several independent solution providers on a single HW Thing.
                            In that case isolation is needed within a single WoT runtime,
                            while (perhaps) sharing solution user preferences and identification.</td>
                    </tr><tr>
                        <th><dfn data-lt="solution user|solution users">
                            Solution User</dfn></th>
                        <td>This might be physical users (e.g. John and his family in their smart home) 
                            or abstract users (e.g. company running a factory).
                            Solution users might differ in their access to the WoT solution capabilities
                            and transferred data
                            (for example, they might only be able to configure certain parts of the solution 
                            or only use solution as it is).</td>
                        <!-- TODO: Are Data confidentiality and Data integrity defined terms?  If so, where 
                             are they defined... in requirements? Should they be marked with links? -->
                        <td>Don't want their data to be exposed to any other solution user,
                            solution provider or OEM unless intended (Data confidentiality).
                            Don't want their data to be modified unless intended (Data integrity).</td>
                        <td>Access to user data might be configurable based not only on "who" 
                            is the entity accessing the data (AC subject), but also his/her/its role,
                            type of access, or based on time and context.</td>
                    </tr>
                </table>

                <p class="ednote" title="Consider adding Security Owner">
                   In addition to the above stakeholders, 
                   we might need to define a notion of 
                   <dfn data-lt="security owner|security owners">Security Owner</dfn>:
                   an entity that provisions a thing with the security root of trust 
                   and sets up the initial policies on who can provision/update/remove scripts
                   to/from the WoT runtime,
                   if such model is supported.
                   A WoT system might generally have a number of independent security owners,
                   each with its own set of provisioned certificates and/or credentials.
                   The exact hierarchy of owners that WoT wants to support is to be discussed.
                 </p>
             </section>

             <section id="wot-threat-model-roles">
             <h3>WoT Supported Physical Roles</h3>
             <p>This section list primary roles that the WoT aims to support.</p>
             <table>
                 <tr>
                     <th>Role</th>
                     <th>Description</th>
                     <th>Level of system access?</th>
                 </tr><tr>
                     <th><dfn data-lt="system maintainer|system maintainers">
                         System Maintainer</dfn></th>
                     <td>Administers a WoT system on behalf of a <a>Solution Provider</a>
                         or <a>Solution User</a>.</td>
                     <td>---</td>
                 </tr>
             </table>

             <p class="ednote" title="System Maintainer role needs to be more clearly defined">
               We need to understand more about the <a>System Maintainer</a> role: 
               what kind of operations would it need to do? 
               Reflash devices, reinstall/install/remove scripts?
               If it has the level of access equal to solution provider,
               we just talk about delegation (and there are security mechnisms to do it),
               not really about a separate role.</p>
             <p class="ednote" title="Are there additional roles?">
               Are there any additional roles we should support?  Having only one role seems rather odd.
               In particular, is the <a>Security Owner</a> mentioned in the previous section a role rather than a 
               stakeholder, and how does this overlap with <a>System Maintainer</a>?
             </p>
         </section>

         <section id="wot-threat-model-assets">
         <h3>Assets</h3>
         <p>This section lists all WoT Assets that are important from security point of view.</p>
         <table>
             <tr>
                 <th>Asset</th>
                 <th>Description</th>
                 <th>Who should have access<br/>(Trust Model)</th>
                 <th>Attack Points</th>
             </tr><tr>
                 <th><dfn data-lt="thing descriptions|td|tds">
                     Thing Description</dfn> (TD)</th>
                 <td>Access Control policies for TDs and the resources it describes are part of TDs 
                     and they are managed using a discretionary access control model 
                     (the owner of a TD sets the AC policy).
                     Some contents of TDs might be privacy sensitive and therefore should not 
                     be shared without a need.
                     The integrity of TDs  is crucial for correct system operation.</td>
                 <td>TD owner: full access<br/> 
                     Others: read only for minimal required part.</td>
                 <td>Storage on thing itself, cloud storage, in-transfer (network) including TD updates.</td>
             </tr><tr>
                 <th><dfn data-lt="thing instances">
                     Thing Instance</dfn></th>
                 <td>The confidentiality of a particular Thing (instance of a class of Things) 
                     should be guaranteed by the system
                     since it might contain privacy-sensitive information.
                     Integrity is also mandatory for correct operation.</td>
                 <td>Thing owner: full access<br/>
                     Others: read only for minimal required part.</td>
                 <td>WoT Runtime</td>
             </tr><tr>
                 <th><dfn>Solution User Data</dfn></th>
                 <td>Can be highly privacy sensitive and confidential.</td>
                 <td>Different <a>solution users</a> might have different levels of access to this data
                     based on the use case.
                     Non-authorized access must be minimized since access even to small amount of information
                     (for example the last timestamp when a door lock API was used) might have severe 
                     privacy converns (example allows an attacker to detect that the owner has been away
                     from his house).
                     Mechanism should be flexible to configure and also include RBAC.<br/>
                     Others: should have no access unless specifically allowed</td>
                 <td>Storage on thing itself, solution provider storage (remote cloud or other),
                     in-transfer (network)</td>
             </tr><tr>
                 <th><dfn data-lt="solution provider scripts|solution provider script">
                     Solution Provider Data</dfn>
                 <td>This includes both scripts and configuration data owned by the
                     solution provider.
                     <a>Solution providers</a> might have Intellectual Property (IP) in their scripts,
                     making them highly confidential.</td>
                 <td><a>Solution provider</a>: full access<br/>
                     Others: no access</td>
                 <td>Storage on the thing itself,
                     remote storage (if scripts are backed up to a remote storage),
                     in-transfer only for initial provisioning and script updates</td>
             </tr><tr>
                 <th><dfn data-lt="thing resource">
                     Thing Resources</dfn><br/> and
                     <dfn data-lt="wot infrastructure resource">
                     WoT Infrastructure Resources</dfn></th>
                 <td>Resources should only be used for legitimate purposes and be available when required.</td>
                 <td><a>Solution User</a></td>
                 <!-- TODO: "WoT Interface" is a term for the network API of a Thing 
                      defined in the WoT architecture document. How do we refer to these,
                      and can we link to their definitions? -->
                 <td>WoT Interface</td>
             </tr><tr>
                 <th><dfn>WoT Controlled Environment</dfn></th>
                 <td>WoT devices that have actuator capabilities are able to affect the physical environment
                     around them.
                     Such capability must only be used by authorized entities and for legitimate purposes only.
                     An actuator capability also implies a possible safety risk.</td>
                 <td></td>
                 <td>WoT Interface</td>
             </tr><tr>
                 <th><dfn>WoT Behavior Metrics</dfn></th>
                 <td>Indirectly transmitted information (metadata) that represents measurements of 
                     a WoT system's behaviour from which other information can be inferred, such as user presence. 
                     For example, the amount of communication between different things,
                     the APIs used, distribution of communication over time, etc.</td>
                 <!-- TODO: is "must" too strong here?  It is very hard to do this in general unless you
                      bury real communication in a bunch of fake data... -->
                 <td>It must not be possible to collect/identify indirectly transferrable information</td>
                 <td>In-transfer data and usage of WoT Interface</td>
             </tr><tr>
                 <th><dfn>Unique Object Identifier</dfn></th>
                 <td>Highly sensitive asset due to privacy implications of tracking. 
                     <p class="ednote" title="Discuss">
                         Need more understanding/discussion on what it is in WoT.
                     </p></td>
                 <td></td>
                 <td></td>
             </tr><tr>
                 <th><dfn>Links</dfn></th>
                 <td>
                     <p class="ednote" title="Discuss">
                         Need more understanding/discussion on what it is in WoT, model around links.
                         Are we talking only about links to other WoT devices, or all links?
                     </p></td>
                 <td></td>
                 <td></td>
              </tr>
          </table>

          <p>The term <dfn>Solution Data</dfn> can be used to refer to either
             <a>Solution User Data</a> or <a>Solution Provider Data</a>.</p>

          <p class="ednote" title="List all keys/credentials">
              List all the keys/credentials that are used on each level and by each protocol. 
              They will be assets and they will be needed if WoT plans to have its own access control policies
              and enforcement. 
              The exact list would depend on chosen solution.
              First step is to obtain the list of protocols that WoT plans to support.
          </p>

          <p>If a WoT system supports dynamic installation of scripts
             inside WoT runtime, the following assets are added:</p>

          <table>
              <tr>
                  <th>Asset</th>
                  <th>Description</th>
                  <th>Who should have access?</br>(Trust Model)</th>
                  <th>Attack Points</th>
              </tr><tr>
                  <th><dfn>Script Provisioning and Update Policies</dfn></th>
                  <td>Defines who can provision, install, update, and remove scripts and other
                      <a>Solution Provider Data</a> inside a WOT runtime.</td>
                  <td><a>System Maintainer</a></td>
                  <td>WoT Management Interface</td>
              </tr>
          </table>

          <p>If a WoT system allows co-existence of different independent <a>solution providers</a>
             on a single physical device, the following assets are added:</p>

          <table>
              <tr>
                  <th>Asset</th>
                  <th>Description</th>
                  <th>Who should have access?</br>(Trust Model)</th>
                  <th>Attack Points</th>
              </tr><tr>
                  <th><dfn>Co-existing Access Control Policies</dfn></th>
                  <td>Access control policites for co-existing solution providers.
                      Not required if a simple baseline policy of "full isolation" is applied to scripts,
                      their execution environment and processed data when having more than two solution
                      providers sharing the same WoT runtime.</td>
                  <td><a>System Maintainer</a></td>
                  <td>Storage on the thing itself, remote storage (if they are backed up to a remote storage),
                      in-transfer for initial provisioning and policy updates</td>
              </tr>
          </table>
      </section>

      <section id="wot-threat-adversaries">
      <h3>Adversaries</h3>
          <p>The following adversaries are in-scope for the WoT threat model: </p>
          <table>
              <tr>
                  <th>Persona</th>
                  <th>Motivation</th>
                  <th>Attacker type</th>
              </tr><tr>
                  <th><dfn>Network Attacker</dfn></th>
                  <td>Unauthorised access or modification of any stakeholder's asset over the network.
                      Denial of service.
                      Taking control of the network component of a WoT system. Reasons: money, fame etc.</td>
                  <td>Network attack: an attacker has network access to a WoT system, 
                      is able to use WoT Interface, perform MitM attacks, 
                      drop, delay, reorder, re-play, and inject messages.</td>
              </tr><tr>
                  <!-- NOTE: removed "solution" here... -->
                  <th><dfn data-lt="malicious authorized solution user|malicious authorized solution users|malicious authorized users">
                      Malicious Authorized User</dfn></th>
                  <td>Unauthorized access of private data of other solution users or other
                      stakeholders (eavesdropping).
                      Unauthorized modification of data of any stakeholder
                      (modification of sensor data).
                      Obtaining higher privileges that originally intended
                      (for example, a hotel guest trying to control overall hotel lighting).</td>
                  <td>Local physical access, WoT configuration point (smartphone, web interface,
                      washing machine interface, etc.</td>
              </tr><tr>
                  <!-- NOTE: removed "solution" here... -->
                  <th><dfn data-lt="malicious unauthorized solution user|malicious unauthorized solution users|malicious unauthorized users">
                      Malicious Unauthorized User</th>
                  <td>Similar to <a>Malicious Authorized User</a>,
                      but with no prior access to the WoT system
                      (examples: guests in a house, guests in a factory)</td>
                  <td>Limited local physical network access, can use proximity factor</td>
              </tr><tr>
                  <th><dfn>Malware Developer - 1</dfn></th>
                  <td>Unauthorised access or modification of any stakeholder's asset.
                      Denial of service.
                      Taking control of WoT system network components.
                      Reasons: money, fame etc.</td>
                  <td>Unprivileged software adversary:
                      application intentionally gets installed or code injected into
                      WoT configuration point (user's smartphone, browser, etc.)
                      or in WoT runtime itself using WoT Interface</td>
              </tr>
          </table>

          <p>The general term <dfn data-lt="malicious users">Malicious User</dfn> may be used to refer to either a
             <a>Malicious Authorized User</a> or a <a>Malicious Unauthorized User</a>.</p>

          <p>If in a WoT system allows the co-existence of different independent solution providers
             on a single physical device, the following adversaries are added:</p>
          <table>
              <tr>
                  <th>Persona</th>
                  <th>Motivation</th>
                  <th>Attacker Type</th>
              </tr><tr>
                  <th><dfn>Malicious Solution Provider</dfn></td>
                  <td>Tries to get access or modify other solution providers scripts or data,
                      tries to access or modify solution users data from another solution provider.</td>
                  <td>Unprivileged software adversary: 
                      <a>solution provider scripts</a> running inside WoT runtime</td>
              </tr>
           </table>

           <p>If a WoT system supports dynamic installation of scripts inside WoT runtime,
              the following adversaries are added:</p>
           <table>
               <tr>
                   <th>Persona</th>
                   <th>Motivation</th>
                   <th>Attacker Type</th>
               </tr><tr>
                   <th><dfn>Malware Developer - 2</dfn></th>
                   <td>Same as <a>Network Attacker</a></td>
                   <td>Same as for <a>Malware Developer - 1</a>,
                       but in addition WoT Management Interface
                       can be used to install attacker's code into WoT runtime.</td>
               </tr>
           </table>

          <p>The general term <dfn data-lt="malware developers">Malware Developer</dfn>
             may be used to refer to either a
             <a>Malware Developer - 1</a> or a <a>Malware Developer - 2</a>.</p>

           <p>The following adversaries are out of scope of the WoT threat model:</p>
           <table>
               <tr>
                   <th>Persona</th>
                   <th>Motivation</th>
                   <th>Attacker Type</th>
               </tr><tr>
		   <th><dfn>Malicious OEM</dfn></th>
		   <td>Intentionally installs HW, firmware or other lower SW level backdoors,
		       rootkits etc. 
		       in order to get unauthorized access to WoT assets or affect WoT system in any form</td>
		   <td>Local physical access, privileged access</td>
	       </tr><tr>
		   <th><dfn>Careless OEM</dfn></th>
		   <td>In order to reduce production costs substitutes security validated original
		       HW parts with low quality unvalidated replacement parts potentially impacting security.</td>
		   <td>Local physical access, privileged access</td>
	       </tr><tr>
		   <th><dfn>Careless Solution Provider</dfn></th>
		   <td>In order to reduce solution deployment costs utilizes low quality SW,
		       performs poor testing, misconfigures hardware or software,
		       TDs and/or access control policies.</td>
		   <td>Local physical access, prilividged access</td>
	       </tr><tr>
		   <th><dfn>Non-WoT End Point Attacker</dfn></th>
		   <td>Tries to get authorized access/modify any asset stored at non-WoT end points
		       (Cloud, non-WoT devices etc.) Reasons: monetary, fame etc.</td>
		   <td>Remote or local attack</td>
               </tr>
           </table>
       </section>

       <section id="wot-threat-model-attack-surfaces">
       <h3>Attack Surfaces</h3>
           <p>In order to correctly define WoT attack surfaces one needs to determine the system's
              trust model as well as execution context boundaries. 
              <a href="#wot-security-fig-attack-surfaces"></a> presents a
              high-level view of the WoT architecture from the security point of view,
              showing all possible execution boundaries.
              However, in practice certain execution boundaries might not be present as they are 
              dependent on the actual device implementation.</p>

           <figure id="wot-security-fig-attack-surfaces">
               <img src="images/WoTArchSecurityView.png"
                    width="100%"
                    title="WoT High-Level Architecture Security View"/>
               <figcaption>WoT High-Level Architecture Security View</figcaption>
           </figure>

           <p>The main execution boundaries for WoT system are:</p>

           <table>
               <tr>
                   <th>Boundary</th>
                   <th>Description</th>
                   <th>Notes</th>
               </tr><tr>
                   <th><dfn>Script Execution Boundary</dfn></th>
                   <td>Separates execution contexts between different scripts
                       and script-provided thing instances.
                       If present,
                       this boundary should be implemented either as having different script runtime
                       contexts (with WoT runtime isolation means) 
                       or by having separate process execution contexts
                       (with OS process isolation means)</td>
                   <td>This boundary is required if we assume that WoT Runtime can run untrusted scripts</td>
               </tr><tr>
                   <th><dfn>WoT Execution Boundary</dfn></th>
                   <td>Separates execution contexts between WoT runtime
                       (including WoT Protocol Bindings) and the rest of the system.
                       If present,
                       this boundary should be implemented at least with OS process isolation means,
                       but in addition can be implemented using any stronger security measures available
                       on the device (Mandatory Access Control, OS-kernel level virtualization,
                       Full Virtualization etc.)</td>
                   <td>This boundary is required if we assume that WoT Runtime might run untrusted scripts
                       or there might be untrusted Protocol Bindings present.
                       It is also required if a device also runs a non-WoT SW stack
                       and elements of that stack can potentially be compromised</td>
               </tr><tr>
                   <!-- TODO: split into two items? -->
                   <th><dfn>WoT Runtime and Protocol Bindings Execution Boundaries</dfn></th>
                   <td>Separate execution contexts between WoT runtime and Protocol Bindings.
                       If present,
                       these boundaries should be implemented at least with OS process isolation means.</td>
                   <td>These boundaries might be needed if we assume that WoT Runtime can run untrusted scripts
                       and would like to implement additional access control measures
                       at the Protocol Binding level.</td>
               </tr>
           </table>

           <p>The following WoT attack surfaces are always in-scope for the WoT Security model:</p>
           <table>
               <tr>
                   <th>System Element</th>
                   <th>Compromise Type(s)</th>
                   <th>Assets Exposed</th>
                   <th>Attack Method</th>
               </tr><tr>
                   <th>WoT Interface</th>
                   <td>Modification/access to <a>TDs</a>,
                       user data modification/data confidentiality,
                       Unauthorized execution of APIs,
                       DoS</td>
                   <td><a>TDs</a>, 
                       <a>Solution User Data</a>,
                       <a>Thing Resources</a>, 
                       <a>WoT Infrastructure Resources</a>,
                       <a>WoT Controlled Environment</a>,
                       <a>WoT Behavior Metrics</a></td>
                   <td>Network attack</td>
               </tr>
                   <th>WoT Scripting APIs</th>
                   <td>Modification/access to <a>TDs</a>,
                       user data modification/data confidentiality,
                       Unauthorized execution of APIs,
                       DoS</td>
                   <td><a>TDs</a>, 
                       <a>Solution User Data</a>,
                       <a>Thing Resources</a>, 
                       <a>WoT Infrastructure Resources</a>,
                       <a>WoT Controlled Environment</a>,
                       <a>WoT Behavior Metrics</a></td>
                   <td>Network attack</td>
               </tr><tr>
                   <th>WoT Discovery Service</th>
                   <td>Modification/access to 
                       <a>TDs</a>,
                       <a>Thing Resources</a>,
                       <a>WoT Infrastructure Resources</a>,
                       <a>WoT Behavior Metrics</a></td>
                   <td><a>TDs</a>,
                       <a>Thing Resources</a>,
                       <a>WoT Infrastructure Resources</a></td>
                   <td>Network attack</td>
               </tr><tr>
                   <th>Protocol Bindings</th>
                   <td>User data modification/data confidentiality,
                       Unauthorized execution of APIs,
                       DoS</td>
                   <td><a>Solution User Data</a>,
                       <a>Thing Resources</a>,
                       <a>WoT Infrastructure Resources</a>,
                       <a>WoT Controlled Environment</a></td>
                   <td>Network attack</td>
               </tr>
           </table>

           <p>The following WoT attack surfaces are only in-scope for the WoT Security model 
              if we assume application scripts can be untrusted
              or we assume co-existence of different solution providers
              on a single physical device:</p>

           <table>
               <tr>
                   <th>System Element</th>
                   <th>Compromise Type(s)</th>
                   <th>Assets Exposed</th>
                   <th>Attack Method</th>
               </tr><tr>
                   <th>WoT Script</th>
                   <td>Component compromise</td>
                   <td><a>TDs</a>,
                       <a>Solution Provider Data</a></td>
                   <td>Local attack by other WoT scripts</a></td>
               </tr><tr>
                   <th>WoT Runtime</th>
                   <td>Component compromise</td>
                   <td><a>TDs</a>,
                       <a>Solution Data</a>,
                       <a>Thing Resources</a>,
                       <a>WoT Infrastructure Resources</a>,
                       <a>WoT Controlled Environment</a></td>
                   <td>Local attack by WoT scripts</td>
               </tr>
           </table>

           <p>If a WoT system allows dynamic installation of scripts inside WoT runtime,
              the following attack surfaces are added:</p>
           <table>
               <tr>
                   <th>System Element</th>
                   <th>Compromise Type(s)</th>
                   <th>Assets exposed</th>
                   <th>Attack Method</th>
               </tr><tr>
                   <th>WoT Script Management API</th>
                   <td>Compromise of application scripts,
                       including installing older version of legitimate scripts (rollback)</td>
                   <td><a>Solution Provider Scripts</a> (part of <a>Solution Provider Data</a>)
                       and their execution environment</td>
                   <td>Network attack</td>
               </tr>
           </table>

           <p class="ednote" title="Untrusted Protocol Bindings">
              Another additional set of attack surfaces might be added
              if we assume that Protocol Bindings can be untrusted.</p>

           <p>The following attack surfaces are out-of-scope for the WoT Security model:</p>
           <table>
               <tr>
                   <th>System Element</th>
                   <th>Compromise Type(s)</th>
                   <th>Assets Exposed</th>
                   <th>Attack Method</th>
               </tr><tr>
                   <th>Non-WoT endpoints</br>
                       (This includes user interface devices, remote Clouds etc.)</th>
                   <td>Component compromise</td>
                   <td><a>TDs</a>,
                       <a>Solution User Data</a>,
                       <a>WoT Infrastructure Resources</a></td>
                   <td>Network attacks,
                       local attacks of all levels</td>
               </tr><tr>
                   <th>Services below WoT Layer</th>
                   <td>Component compromise on levels below WoT</td>
                   <td>Modification/access to <a>TDs</a>,
                       <a>Thing Resources</a>,
                       <a>WoT Infrastructure Resources</a></td>
                   <td>Network attacks,
                       local attacks of all levels</td>
               </tr>
           </table>
       </section>

       <section>
       <h3>Threats</h3>
       <p>This section lists all basic WoT threats, both in-scope and out-of-scope.</p>

       <p>The WoT threat model assumes that the WoT User Interface
         (which might reside on a non-WoT device, such as a smartphone, a PC browser, etc.)
         communicates with WoT network using standard WoT Interfaces and WoT Protocol Bindings.
         In order to minimize the attack surface,
         it is strongly recommended that no other separate communication means is provided for this purpose.
         This threat model makes the assumption that this recommendation is followed.
         It is also assumed that WoT Protocol Bindings are trusted and cannot come from untrusted parties.

         <p class="ednote" title="Protocol Bindings as Solution Provider Data">
            We should dicuss whether Protocol Bindings should be considered part of Solution Provider Data.
            This makes sense if the Solution Provider is the one configuring the system capabilities, including
            protocol bindings.  Note that if this configuration is done by the OEM, then they are a Solution
            Provider, but there may be <em>another</em> solution provider building on top of the basic configuration
            provided by the OEM.
         </p>

       <table>
           <tr>
               <th>Threat</th>
               <th>Adversary</th>
               <th>Asset</th>
               <th>Attack method and pre-conditions</th>
           </tr><tr>
               <th><dfn>Non-WoT End Point Threat</dfn></th>
               <td>All attacker types</td>
               <td><a>TDs</a>,
                   <a>Solution User Data</a>,
                   <a>WoT Infrastructure Resources</a>
                   stored at non-WoT end points (Cloud, non-WoT devices etc.)</td>
               <td><strong>Attack method:</strong>
                   Any remote or local attack method that results in attacker obtaining
                   unauthorized access or the ability to modify assets stored at
                   the Non-WoT End Point or to cause a DoS attack on the service itself.</td>
           </tr><tr>
               <th><dfn>WoT Platform Threat</dfn></th>
               <td>All attacker types</td>
               <td><a>TDs</a>,
                   <a>Solution Data</a>,
                   <a>WoT Infrastructure Resources</a></td>
               <td><strong>Attack method</strong>: 
                   Any local or remote attack method on levels below WoT runtime
                   that results in attacker obtaining unauthorized access 
                   or being able to modify assets stored at things,
                   or causing a DoS attack on things or WoT infrastructure.</td>
           </tr><tr>
               <th><dfn>WoT Protocol Binding Threat</dfn></th>
               <td><a>Network Attacker</a>,
                   <a>Malware Developer - 1</a>,
                   <a>Malicious Users</a></td>
               <td>Compromising Protocol Bindings and getting access/control
                   to all WoT assets within the same execution boundary</td>
               <td><strong>Pre-conditions:</strong>
                   General preconditions for network attacker with access to the WoT Interface.
                   In case of <a>Malicious Authorized Solution User</a>
                   or <a>Malware developer - 1</a>
                   also access to solution user credentials available on the configuration interface 
                   (smartphone, tablet etc.)<br/>
                   <strong>Attack method:</strong>
                   Any remote attack method using WoT Interface or directly
                   using protocol binding interfaces with the purpose of
                   compromising protocol binding component and access to all available WoT assets</td>
           </tr><tr>
               <th><dfn>WoT Interface Threat - General Compromise</dfn></th>
               <td><a>Network Attacker</a>, 
                   <a>Malware Developer - 1</a>,
                   <a>Malicious Users</a></td>
               <td>Compromising <a>Thing instance</a> and getting access/control
                   to all available WoT assets in the same execution boundary</td>
               <td><strong>Pre-conditions:</strong>
                   General preconditions for network attacker with access to the WoT Interface.
                   In case of <a>Malicious Authorized User</a>
                   or <a>Malware Developer - 1</a> also has access to solution user credentials
                   available on the configuration interface (smartphone, tablet etc.)<br />
                   <strong>Attack method</strong>:
                   Any remote attack method using WoT Interface with the purpose
                   of compromising the <a>Thing Instance</a>
                   and as a result getting access/control to all available WoT assets
                   within the same execution boundary</td>
           </tr><tr>
               <th><dfn>WoT Interface Threat - Unauthorized API Access</dfn></th>
               <td><a>Network Attacker</a>,
                   <a>Malware Developer - 1</a>,
                   <a>Malicious Unauthorized Users</a>,
                   <a>Malicious Solution Provider</a></td>
               <td>Unauthorized access to an asset provided via WoT Interface
                   (<a>WoT controlled environment</a>,
                    <a>solution user data</a>,
                    non-public parts of <a>TDs</a>, etc.)</td>
               <td><strong>Pre-conditions:</strong>
                   An attacker with an access to the WoT client API<br/>
                   <strong>Attack method:</strong>
                   Any remote attack method using WoT Interface 
                   with the purpose of obtaining unauthorized access to a WoT asset</td>
           </tr><tr>
               <th><dfn>WoT TD Privacy Threat</dfn></th>
               <td><a>Network Attacker</a>,
                   <a>Malware Developer - 1</a></td>
               <td>Unauthorized access to privacy-sensitive data exposed via <a>TD</a></td>
               <td><strong>Attack method:</strong>
                   Passive observation of a <a>TD</a> during transfer or at storage</td>
           </tr><tr>
               <th><dfn>WoT TD Threat - Local Storage</dfn></th>
               <td><a>Malware Developer - 1</a></td>
               <td><a>TDs</a> authenticity</td>
               <td><strong>Attack method:</strong>
                   Any local or remote attack method on <a>TD</a> in-storage the purpose of its modification,
                   including rolling back to an older version of <a>TD</a></td>
           </tr><tr>
               <th><dfn>WoT DoS Threat</dfn></th>
               <td><a>Network Attacker</a>,
                   <a>Malware Developer - 1</a>,
                   <a>Malicious Authorized User</a></td>
               <td><a>Thing Resources</a>,
                   <a>WoT Infrastructure Resources</a>,
                   Infrastructure operability</td>
               <td><strong>Pre-conditions:</strong>
                   General preconditions for network attacker with access to the WoT Interface<br/>
                   <strong>Attack method:</strong>
                   Any attack method using WoT Interface in order to cause DoS to an end thing,
                   device or infrastructure
                   (calling WoT Interface methods that require processing, sending too many messages etc.)
                   or to disturb the service operation by intentional dropping
                   of all or selective WoT messages</td>
            </tr><tr>
                <th><dfn>WoT Communication Threat - TD Authenticity</dfn></th>
                <td><a>Network Attacker</a>,
                    <a>Malware Developer - 1</a>,
                    <a>Malicious Users</a>,
                    <a>Malicious Solution Provider</a></td>
                <td>TDs authenticity in-transfer</td>
                <td><strong>Pre-conditions:</strong>
                    General preconditions for network attacker with access to the WoT Interface<br/>
                    <strong>Attack method:</strong>
                    Any attack method on <a>TDs</a> in-transfer with the purpose of its modification,
                    including rolling back to an older version of a <a>TD</a></td>
            </tr><tr>
                <th><dfn>WoT Communication Threat - TD Confidentiality</dfn></th>
                <td><a>Network Attacker</a>,
                    <a>Malware Developer - 1</a>,
                    <a>Malicious Users</a>,
                    <a>Malicious Solution Provider</a></td>
                <td><a>TDs</a> confidentiality in-transfer</td>
                <td><strong>Pre-conditions:</strong>
                    General preconditions for network attacker with access to the WoT Interface<br/>
                    <strong>Attack method:</strong>
                    Any attack method on TDs in-transfer with the purpose of obtaining unauthorized
                    access to non-public parts of TDs</td>
             </tr><tr>
                 <th><dfn>WoT Communication Threat - Solution Data Authenticity</dfn></th>
                 <td><a>Network Attacker</a>,
                     <a>Malware developer - 1</a>,
                     <a>Malicious Users</a>,
                     <a>Malicious Solution Provider</a></td>
                 <td><a>Solution data</a> authenticity in-transfer</td>
                 <td><strong>Pre-conditions:</strong>
                     General preconditions for network attacker with access to the WoT Interface<br/>
                     <strong>Attack method:</strong>
                     Any attack method on solution data in-transfer with the purpose of its modification,
                     including sequence of received data,
                     its freshness and illegitimate replay</td>
             </tr><tr>
                 <th><dfn>WoT Communication Threat - Solution Data Confidentiality</dfn></th>
                 <td><a>Network Attacker</a>,
                     <a>Malware Developer - 1</a>,
                     <a>Malicious Users</a>,
                     <a>Malicious Solution Provider</a></td>
                 <td><a>Solution data</a> confidentiality in-transfer</td>
                 <td><strong>Pre-conditions:</strong>
                     General preconditions for network attacker with access to the WoT Interface<br/>
                     <strong>Attack method:</strong>
                     Any attack method on solution data in-transfer with the purpose of obtaining
                     unauthorized access</td>
             </tr><tr>
                 <th><dfn>WoT Communication Threat - Side Channels</dfn></th>
                 <td><a>Network attacker</a>,
                     <a>Malicious users</a>,
                     <a>Malicious solution provider</a></td>
                 <td><a>WoT Behavior Metrics</a></td>
                 <td><strong>Pre-conditions:</strong>
                     General preconditions for network attacker with access to the WoT client API<br/>
                     <strong>Attack method:</strong>
                     Passive observation of WoT network and messages with the intention to learn 
                     behavioural and operational patterns</td>
             </tr>
         </table>

         <p class="ednote" title="Break up WoT Platform Threat">
             Currently the <a>WoT Platform Threat</a> incorporates all kinds of attacks on
             levels below the WoT runtime. We might want to break it up a bit later on.
         </p>
         <p class="ednote" title="Policy management threats to be added">
             Need to add all threats to credentials/policy management, if any
         </p>

         <p>If a WoT system allows dynamic installation of scripts inside a WoT runtime,
            the following threats are added:</p>
         <table>
             <tr>
                 <th>Threat</th>
                 <th>Adversary</th>
                 <th>Asset</th>
                 <th>Attack method and pre-conditions</th>
             </tr><tr>
                 <th><dfn>WoT Script Mgm API Threat - 1</dfn></th>
                 <td><a>Network Attacker</a>,
                     <a>Malware Developer</a>,
                     <a>Malicious Users</td>
                 <td>Execution inside WoT Runtime (stepping stone to other further local attacks) 
                     and all assets within WoT Runtime</td>
                 <td><strong>Pre-conditions:</strong>
                     General preconditions for network attacker with access to the WoT Script Mgm API<br>
                     <strong>Attack method:</strong>
                     Attacker installs its own script into WoT runtime using WoT Script Management API
                     or compromises WoT Runtime itself using WoT Script Management API</td>
             </tr><tr>
                 <th><dfn>WoT Script Mgm API Threat - 2</dfn></th>
                 <td><a>Network Attacker</a>,
                     <a>Malware Developer</a>,
                     <a>Malicious Users</td>
                 <td>Execution inside WoT Runtime (stepping stone to other further local attacks)
                     and all assets within WoT Runtime</td>
                 <td><strong>Pre-conditions:</strong>
                     General preconditions for network attacker with access to the WoT Script Mgm API<br/>
                     <strong>Attack method:</strong>
                     Attacker compromises WoT Runtime itself using WoT Script Management API</td>
             </tr><tr>
                 <th><dfn>WoT Script Mgm API Threat - 3</dfn></th>
                 <td><a>Network Attacker</a>,
                     <a>Malware Developer</a>,
                     <a>Malicious Users</td>
                 <td><a>Thing resources</a>,
                     Infrastructure operability</td>
                 <td><strong>Pre-conditions:</strong>
                     General preconditions for network attacker with access to the WoT Script Mgm API<br/>
                     <strong>Attack method:</strong>
                     Attacker misuses WoT Script Management API to cause DoS on things or infrastructure,
                     including deleting, corrupting WoT scripts</td>
             </tr>
         </table>

         <p>The general term <dfn>WoT Script Mgm API Threat</dfn> may be used to refer to any or all of
             <a>WoT Script Mgm API Threat - 1</a>, 
             <a>WoT Script Mgm API Threat - 2</a>, or 
             <a>WoT Script Mgm API Threat - 3</a>.</p>

         <p>If a WoT system allows co-existence of different independent solution providers on a
            single physical device or if WoT scripts are assumed to be untrusted,
            it brings the following new threats in addition to the above ones:</p>
         <table>
            <tr>
               <th>Threat</th>
               <th>Adversary</th>
               <th>Asset</th>
               <th>Attack method and pre-conditions</th>
            </tr><tr>
               <!-- TODO: make name more specific, this is too generic, given other "Wot Script" threats below...
                    unless it is MEANT to be generic, in which case we should define it in terms of the other
                    ones as with terms like "Malicious User" -->
               <th><dfn>WoT Script Threat</dfn></th>
               <td><a>Malicious Solution Provider</a>,
                   <a>Malware Developer</a>,
                   <a>Malicious Users</a> (if they can install their own scripts)</td>
               <td>Component compromise</td>
               <td><strong>Pre-conditions:</strong>
                   An attacker has a full control over the script running inside WoT runtime either
                   legitimately (<a>solution provider script</a>) or by compromising a solution provider script or
                   by installing its own script by other means.<br/>
                   <strong>Attack method:</strong>
                   Any local attack method on another script running in the same WoT runtime that results
                   in an attacker compromising that script and getting controls over it</td>
            </tr><tr>
                <th><dfn>WoT Runtime Threat</dfn></th>
                <td><a>Malicious Solution Provider</a>,
                    <a>Malware Developer</a>,
                    <a>Malicious Users</a> (if they can install their own scripts)</td>
                <td>Component compromise</td>
                <td><strong>Pre-conditions:</strong>
                    An attacker has a full control over the script running inside WoT runtime either
                    legitimately (<a>solution provider script</a>) or by compromising a solution provider script or
                    by installing its own script by other means.<br/>
                    <strong>Attack method:</strong>
                    Any local attack method on WoT runtime with the intent of elevating its privileges
                    to WoT runtime level</td>
             </tr><tr>
                 <th><dfn>WoT Script Threat - Confidentiality</dfn></th>
                 <td><a>Malicious Solution Provider</a>,
                     <a>Malware Developer</a>,
                     <a>Malicious Users</a> (if they can install their own scripts)</td>
                 <td><a>Solution provider scripts</a> and configuration confidentiality</td>
                 <td><strong>Pre-conditions:</strong>
                     An attacker has a full control over the script running inside WoT runtime either
                     legitimately (<a>solution provider script</a>) or by compromising a solution provider script or
                     by installing its own script by other means.<br/>
                     <strong>Attack method:</strong>
                     Any local attack method on another script running in the same WoT runtime that results
                     in an attacker obtaining knowledge about a script or its configuration</td>
              </tr><tr>
                  <th><dfn>WoT Script Threat - Authenticity</dfn></th>
                  <td><a>Malicious Solution Provider</a>,
                      <a>Malware Developer</a>,
                      <a>Malicious Users</a> (if they can install their own scripts)</td>
                  <td><a>Solution provider scripts</a> and configuration authenticity</td>
                  <td><strong>Pre-conditions:</strong>
                      An attacker has a full control over the script running inside WoT runtime either
                      legitimately (<a>solution provider script</a>) or by compromising a solution provider script or
                      by installing its own script by other means.<br/>
                      <strong>Attack method:</strong>
                      Any local attack method on another script running in the same WoT runtime that results
                      in attacker in modifying script or its configuration,
                      including rolling back to an older version of a script</td>
              </tr><tr>
                  <th><dfn>WoT Local Threat - TD Authenticity</dfn></th>
                  <td><a>Malicious Solution Provider</a>,
                      <a>Malware Developer</a>,
                      <a>Malicious Users</a> (if they can install their own scripts)</td>
                  <td>TDs authenticity as stored on a thing</td>
                  <td><strong>Pre-conditions:</strong>
                      An attacker has a full control over the script running inside WoT runtime either
                      legitimately (<a>solution provider script</a>) or by compromising a solution provider script or
                      by installing its own script by other means.<br/>
                      <strong>Attack method:</strong>
                      Any local attack method on another script running in the same WoT runtime that results
                      in attacker unauthorized modification of <a>TDs</a>,
                      including rolling back to an older version of TD</td>
              </tr><tr>
                  <th><dfn>WoT Local Threat - TD Confidentiality</dfn></th>
                  <td><a>Malicious Solution Provider</a>,
                      <a>Malware Developers</a>,
                      <a>Malicious Users</a> (if they can install their own scripts)</td>
                  <td><a>TDs</a> integrity as stored on a thing</td>
                  <td><strong>Pre-conditions:</strong>
                      An attacker has a full control over the script running inside WoT runtime either
                      legitimately (<a>solution provider script</a>) or by compromising a solution provider script or
                      by installing its own script by other means.<br/>
                      <strong>Attack method:</strong>
                      Any local attack method on another script running in the same WoT runtime that results
                      in attacker unauthorized access to non-public parts of <a>TDs</a>.</td>
              </tr><tr>
                  <th><dfn>WoT Local Threat - Solution Data Authenticity</dfn></th>
                  <td><a>Malicious Solution Provider</a>,
                      <a>Malware Developer</a>,
                      <a>Malicious Users</a> (if they can install their own scripts)</td>
                  <td><a>Solution data</a> authenticity as stored/processed on a thing</td>
                  <td><strong>Pre-conditions:</strong>
                      An attacker has a full control over the script running inside WoT runtime either
                      legitimately (<a>solution provider script</a>) or by compromising a solution provider script or
                      by installing its own script by other means.<br/>
                      <strong>Attack method:</strong>
                      Any local attack method on another script running in the same WoT runtime that results
                      in attacker in being able to modify <a>solution data</a>,
                      including rolling back to an older version</td>
              </tr><tr>
                  <th><dfn>WoT Local Threat - Solution Data Confidentiality</dfn></th>
                  <td><a>Malicious Solution Provider</a>,
                      <a>Malware Developer</a>,
                      <a>Malicious Users</a> (if they can install their own scripts)</td>
                  <td><a>Solution data</a> confidentiality as stored/processed on a thing</td>
                  <td><strong>Pre-conditions:</strong>
                      An attacker has a full control over the script running inside a WoT runtime either
                      legitimately (<a>solution provider script</a>) or by compromising a solution provider script or
                      by installing its own script by other means.<br/>
                      <strong>Attack method:</strong>
                      Any local attack method on another script running in the same WoT runtime that results
                      in an attacker getting unauthorized access to <a>solution data</a></td>
              </tr><tr>
                  <th><dfn>WoT Local Threat - DoS</dfn></th>
                  <td><a>Malicious Solution Provider</a>
                      <a>Malware Developer</a>,
                      <a>Malicious Users</a> (if they can install their own scripts)</td>
                  <td><a>Thing resources</a>,
                      Infrastructure operability of other <a>solution providers</a></td>
                  <td><strong>Pre-conditions:</strong>
                      An attacker has a full control over the script running inside WoT runtime either
                      legitimately (solution provider script) or by compromising a <a>solution provider</a> script
                      or by installing its own script by other means.<br/>
                      <strong>Attack method:</strong> 
                      Any local attack method with the goal of consuming things or infrastructure resources
                      that disturb legitimate operation of co-existing providers.</td>
              </tr>
          </table>
      </section>
  </section>

        <section id="wot-security-objectives">
        <h2>Security Objectives</h2>
            <p>
              Practical examples of typical high-level WoT scenarios and their security objectives are given here.   
            </p>

<section>
<h3>Scenario 1 - Home environment</h3>

<p>In this scenario we assume a standard home environment with a WoT network running behind a firewall that separates it from the rest of the Internet. However the WoT network is shared with the standard user home network that contains other non-WoT devices that have high chances of being compromised. This results on viewing these non-WoT devices as network attackers with access to WoT network and its APIs/Protocol Bindings. WoT scripts and protocol bindings are considered trusted, single solution provider exists on physical WoT devices, no dynamic installation of WoT scripts are possible.</p>

<p>This scenario implies the following <strong>WoT Security objectives</strong>:</p>

<table>

<tr>
<th><strong>Threat name</strong></th>
<th><strong>Example(s)</strong></th>
<th><strong>Mitigation</strong></th>
</tr>


<tr>
<td><strong>WoT Protocol Bindings</strong></td>
<td>A compromised application on a user smartphone connected to the same internal network as WoT devices sends a malformed request to a WoT device using directly Protocol Bindings interface. This malformed request causes the respective Protocol Binding to be compromised and attacker is able to run the code with the privileges of the Protocol Binding on the WoT device.</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT Interface - General Compromise</strong></td>
<td>A compromised application on a user smartphone connected to the same internal network as WoT devices sends a malformed request to a WoT device using WoT interface. This malformed request causes the respective Thing Instance to be compromised and attacker is able to run the code with the privileges of the Thing Instance on the WoT device.</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT Interface - Unauthorized API access</strong></td>
<td>A user's party guest with the network access to the same internal network as WoT devices using his device sends a WoT interface request to a user's WoT device for a certain resource access, for example, to get a video stream from user's video camera footage or permission to unlock some rooms in the house. Due to lack of proper authentication, it is able to access this information or execute the required action (opening the door).</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT communication - TD Authenticity</strong></td>
<td>A compromised application on a user smartphone connected to the same internal network as WoT devices listens to the network and intercepts a legitimate TD send by one of the WoT devices. Then it modifies the TD to state different authentication method or authority and forwards it to the intended device. The device follow the instructions in the modified TD and sends authentication request to the attacker's specified location potentially revealing its credentials, such as keys etc. Similarly instead of modifying the legitimate TD, an attack might save it and use later on, for example when it would be updated to a newer version. Then, an attacker substitutes a new version of TD with an older version to cause DoS to a device trying to get an access to a resource. An additional reason for using an older TD might be exposing a previously available vulnerable interface that got hidden when TD was updated to a newer version. This can be a stepping stone to conducting other attacks on the WoT network.</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT communication - TD Confidentiality</strong></td>
<td>A user's party guest with the network access to the same internal network as WoT devices using his device listens to the network and intercepts a legitimate TD send by one of the WoT devices. While inspecting the TD he/she learns the privacy-sensitive information about the host, such as presence of medical tracking/assistant equipment, name of healthcare provider company etc.</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT communication - Solution Data Authenticity</strong></td>
<td>A user's party guest with the network access to the same internal network as WoT devices using his device listens to the network and intercepts a legitimate WoT interface request to set some settings on some actuator, for example the time when house doors get locked and unlocked. He then modifies the specified value to the desirable one and then forwards the request to the destination WoT device. The destination WoT device accepts incorrect settings.<br />Another attack example is a replay of a legitimate WoT interface request to set a setting, for example, increase temperature of the house by a number of degrees. When repeated many times, it might not only make living environment unusable, but also break heating equipment.<br />Another attack involves replaying an old legitimate WoT interface request that attacker intercepts while visiting user's home, such as command to unlock the doors, stop camera recordings etc. in a different time when user wants to get authorized access to the house.</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT communication - Solution Data Confidentiality</strong></td>
<td>A user's party guest with the network access to the same internal network as WoT devices using his device listens to the network and intercepts WoT interface exchange between legitimate entities. From that exchange the guest learns the privacy-sensitive information about the host, such as data stream from his medical tracking equipment, information about user's preferences in home environment, video/audio camera stream etc.</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT DoS</strong></td>
<td>A compromised application on a user smartphone connected to the same internal network as WoT devices sends huge amount of requests to either a single WoT device or all device available in the WoT network using directly Protocol Bindings interface or WoT interface. These requests fully take the processing bandwidth of a WoT device or WoT network and make it impossible for legitimate users to communicate with WoT devices or devices to communicate with each other. Depending on the implementation it can also lead to the case that alarm or authentication systems might be disabled and thieves get into user's house (however systems should always implement "safe defaults" principle and in such cases keeps doors closed despite of inability to authenticate).</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT TD Privacy</strong></td>
<td>A compromised application on a user smartphone connected to the same internal network as WoT devices listens for publicly broadcasted TDs and sends this data to a remote attacker to build a profile of home installed devices and their purpose.</td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT TD - Local Storage</strong></td>
<td></td>
<td>TBD</td>
</tr>

</table>

<p>As well as the following <strong>Security non-objectives</strong>:</p>

<table>

<tr>
<th><strong>Threat name</strong></th>
<th><strong>Reasoning &amp; recommendation</strong></th>
</tr>


<tr>
<td><strong>Non-WoT End Point</strong></td>
<td><strong>Reasoning</strong> : The security of non-WoT end points and their external interfaces is out of the WoT scope. <strong>Recommendations</strong> : Solution providers and OEMs are recommended to use industry best security practices when designing their non-WoT End points, protocols and interfaces.</td>
</tr>
<tr>
<td><strong>WoT Platform</strong></td>
<td>TBD</td>
</tr>
<tr>
<td><strong>WoT communication Side Channels</strong></td>
<td>TBD</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
    </section>
 
    <section>
    <h3>Scenario 2 - Business/Corporate environment</h3>

    <p>In this scenario we assume an office building environment that is shared between a number of independent companies with a WoT network running that controls temperature, lights, video surveillance, air etc.</p>

    <p class="ednote" title="Fill in the content">
      This subsection content needs to be added.
    </p>

    <p>This scenario implies the following <strong>WoT Security objectives</strong>:</p>

    <table>
    <tr>
    <th><strong>Threat name</strong></th>
    <th><strong>Example(s)</strong></th>
    <th><strong>Mitigation</strong></th>
    </tr>

    <tr>
    <td><strong>WoT Protocol Bindings</strong></td>
    <td> </td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT Interface - General Compromise</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT Interface - Unauthorized API access</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication - TD Authenticity</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication - TD Confidentiality</strong></td>
    <td> </td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication - Solution Data Authenticity</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication - Solution Data Confidentiality</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT DoS</strong></td>
    <td>A</td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT TD Privacy</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT TD - Local Storage</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    </table>

    <p>As well as the following <strong>Security non-objectives</strong>:</p>

    <table>
    <tr>
    <th><strong>Threat name</strong></th>
    <th><strong>Reasoning &amp; recommendation</strong></th>
    </tr>
    <tr>
    <td><strong>Non-WoT End Point</strong></td>
    <td><strong></td>
    </tr>
    <tr>
    <td><strong>WoT Platform</strong></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication Side Channels</strong></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td></td>
    <td></td>
    </tr>
    </table>
    </section>

    <section>
    <h3>Scenario 3 - Industrial/Critical infrastructure environment</h3>

    <p>In this scenario we assume an industrial factory or infrastructure (power plant, water distribution system) environment that is using WoT network to monitor or perform certain automation tasks.</p>

    <p class="ednote" title="Fill in the content">
      This subsection content needs to be added.
    </p>

    <p>This scenario implies the following <strong>WoT Security objectives</strong>:</p>

    <table>
    <tr>
    <th><strong>Threat name</strong></th>
    <th><strong>Example(s)</strong></th>
    <th><strong>Mitigation</strong></th>
    </tr>

    <tr>
    <td><strong>WoT Protocol Bindings</strong></td>
    <td> </td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT Interface - General Compromise</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT Interface - Unauthorized API access</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication - TD Authenticity</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication - TD Confidentiality</strong></td>
    <td> </td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication - Solution Data Authenticity</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication - Solution Data Confidentiality</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT DoS</strong></td>
    <td>A</td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT TD Privacy</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT TD - Local Storage</strong></td>
    <td></td>
    <td>TBD</td>
    </tr>
    </table>

    <p>As well as the following <strong>Security non-objectives</strong>:</p>

    <table>
    <tr>
    <th><strong>Threat name</strong></th>
    <th><strong>Reasoning &amp; recommendation</strong></th>
    </tr>
    <tr>
    <td><strong>Non-WoT End Point</strong></td>
    <td><strong></td>
    </tr>
    <tr>
    <td><strong>WoT Platform</strong></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td><strong>WoT communication Side Channels</strong></td>
    <td>TBD</td>
    </tr>
    <tr>
    <td></td>
    <td></td>
    </tr>
    </table>
    </section>

   </section>
   <section>
   <h2>Determining a suitable security architecture</h2>
            <p> 
              <!-- todo: List the criteria that raise risk level for particular WoT architecture, such as handing privacy-sensitive data, physical safety, etc. (we started to build this list, need to finish)  --> 
              <!-- todo: Talk about capabilities of devices themselves, what security protocols are supported, how processes isolation is implemented (granularity: everything runs as one process, only kernel - vs. userspace isolation, process isolation, script isolation etc.), etc.   -->
              <!-- todo: List additional factors that are important in selecting security architecture   -->
            </p>
    </section>

  </section>

  <section>
  <h1>Existing Security Best Practices in related fields</h1>
      <p class="ednote" title="Fill in the content">
          This section content needs to be added.
      </p>
  </section>

  <section>
  <h1>Recommended Security Practices</h1>
      <p>
        Based on the security assets and threats listed above, we provide a set of recommended practices for
        enhancing security and privacy when designing various aspects of WoT network.
      </p>

      <section>
        <h2>Secure Practices for designing a Thing Description</h2>

        <section>
        <h3>Secure Delivery and Storage of Thing Description</h3>
            <p>
    	         When a TD is transferred between endpoints, 
                it is important to at least use secure protocols guaranteeing
    	          data authenticity and in many cases confidentiality 
                (depending on whenever a TD contains any confidential information)
                to avoid manipulation of a TD. 
            </p>
            <p>
              If end-to-end TD authenticity is required,
              it is possible to sign TD objects with either digital signatures 
              (using asymmetric cryptographic primitives) 
              or Message Authentication Codes (MACs, using symmetric cryptographic primitives).
              Such digital signatures or MACs are created by the producers/issuers of TD objects
              and validated by consumers of TD objects (which should reject signed TD objects whose signatures/MACs are invalid).
              For TD objects expressed in JSON,
              RFC 7515 (IETF JSON Web Signature: https://datatracker.ietf.org/doc/rfc7515/)
              provides guidelines for computation and validation of digital signatures or MACs using JSON-based data structures. 
            </p>
            <p>
              Similarly, if end-to-end TD confidentiality is required
              (though probably a much more rare case than authenticity),
              it is possible to encrypt TD objects using available cryptographic encryption primitives.
              For TD objects expressed in JSON,
              RFC 7516 (IETF JSON Web Encryption: https://datatracker.ietf.org/doc/rfc7516/)
              provides the guidelines for encryption and decryption of JSON-based data structures. 
  	          When TD is stored at the end device or remote storage,
              its authenticity and in some cases confidentiality should
  	          also be protected using the best available local methods.
              An access control mechanism should also be used that prevents 
  	          illegitimate modification of any of the TD's parts. 
            </p>
            <p>
  	          This recommendation helps prevent the following threats: 
              WoT Communication - TD Authenticity,
              WoT Communication - TD Confidentiality,
              WoT TD - Local Storage.
            </p>
        </section>

        <section>
        <h3>Use Secure Transports</h3>
            <p> 
	           When defining protocols for APIs exposed by a TD, 
             it is often important to use secure protocols guaranteeing
	           data authenticity and confidentiality.
            For example, coaps and https should be preferred to coap and http whenever possible.
            </p>
            <p>
	          This recommendation helps prevent the following threats: 
            WoT Communication - Solution Data Authenticity,
            WoT Communication - Solution Data Confidentiality.
            </p>
        </section>

        <section>
	     <h3>Avoid Heavy Functional Processing without Authentication</h3>
            <p>
  	          When defining WoT Interfaces exposed by a TD,
              it is important to avoid any heavy functional processing before the successful authentication
  	         of a WoT client.
              Any publicly exposed network interface should avoid heavy processing altogether. 
            </p>
            <p>
	           This recommendation helps prevent the following threats: 
            WoT DoS.
            </p>
        </section>

        <section>
	      <h3>Avoid Exposing Immutable Identifiers</h3>
            <p>
	           When defining fields exposed by a TD personally identifiable information should be avoided.
	           It is also strongly recommended to avoid exposing any immutable hardware identifiers.
             Instead it is recommended to use "soft identifiers", i.e. identifiers that can be changed during device lifecycle.
            </p>
            <p>
	          This recommendation helps prevent the following threats: 
            WoT TD - Privacy.
            </p>
        </section>

        <section>
	      <h3>Minimize Network Interface Functionality</h3>
            <p>
	          Network interfaces exposed by a TD (WoT Interfaces) should only provide the minimal necessary functionality,
            which helps to minimize implementation errors,
	         possibilities for exposing potentially sensitive data, DoS attack possibilities etc.  
	         Devices should be strongly encapsulated, meaning the network interfaces should not expose implementation details
            (for example, the use of particular software frameworks).
	         Consider different levels of access for different users.
            </p>
            <p>
	         This recommendation helps prevent the following threats: 
            WoT Interface - General compromise, 
            WoT Interface - Unauthorized API access, 
            WoT DoS. 
            </p>
        </section>
      </section>
    
      <section>
      <h2>Secure Practices for designing WoT Scripts and WoT Script APIs</h2>
          <p class="ednote" title="Fill in the content">
          This subsection content needs to be added.
          </p>
      </section>

    </section>

    <section>
    <h1>Examples of WoT security configurations</h1>
        <p>
          WoT is intended to be used in variety of use cases and configurations. While the below list does not cover all possible deployment variations, it covers
          the most common cases and shows the ways how security mechanisms can be configured for them, as well brings attention to the relevant details.
        </p>

           <section>
           <h2>Basic Interaction between WoT Thing and WoT Client</h2>
            <p>
              <a href="#wot_client_thing_basic"></a> shows the basic WoT Client (can be a browser or application on a user smartphone) that is used to operate the WoT Thing (Garage door controller or other HW device). The latter exposes a WoT interface and provides a Thing Description with actions that can be performed on a Thing.
            </p>
            <figure id="wot_client_thing_basic">
              <img src="images/client-server-basic.png" style="width: 1000px;" />
              <figcaption>Basic WoT Thing and WoT Client</figcaption>
            </figure>
            <p>
            From a security point of view two aspects are important to consider in this scenario. First the WoT Client should be certain that it is talking to the correct WoT Thing and not to some arbitrary device
            exposed in the WoT network. I.e. user performing controls on the garage door wants to make sure it is talking to his or her garage door device. In security terms it means that WoT Client must have a way to
            authenticate the device exposing the WoT Thing. Second, upon receiving any requests from WoT Client, WoT Thing must verify the the WoT Client is authorized to perform such requests. I.e. garage door must only process requests from devices associated with user or service provider and not from arbitrary guests in the house.
            </p>
            <p>
            Both aspects can be fulfilled using different security mechanisms and the end decision on a concrete method depends on the deployment scenario, as well as capabilities of involved devices. The WoT Client is not expected be a resource limited device, but the device exposing the WoT Thing might have some resource constraints. Also, it is important to mention that even if the WoT Thing does not expose any sensitive device resources or actions, mutual authentication between the WoT Client and the device exposing the WoT Thing is strongly recommended and might be even required for some underlying protocols.
            </p>
            <p class="ednote" title="Fill in the protocols">
            Need to fill in the list of underlying protocols that actually require mutual authentication.
            </p>
            <p>
            The WoT Client and the device exposing the WoT thing can use one of the following methods recommended by the OCF Security Specification [[Ocf17]] (see Section 10) to mutually authenticate each other:
            <ul>
            <li><strong>Symmetric key credentials.</strong> This method assumes that both WoT Client and the device exposing WoT Thing has pre-shared symmetric key credentials. Such keys can be established during device provisioning/on-boarding phase using one of the methods recommended in Section 7 [[Ocf17]] or using ad-hoc security protocols, such as Diffie-Hellman based on other existing pre-shared credentials. See Section 9.2.1 [[Ocf17]] for more details on such credential type.</li>
            <li><strong>Raw asymmetric key credentials.</strong> This method assumes that WoT Client has been provisioned with the public key of the device exposing the WoT thing (and visa versa) and able to authenticate the device based on it. The provisioning of public key can similarly happen during device provisioning/on-boarding phase using one of the methods recommended in Section 7 [[Ocf17]]. Section 9.2.3 [[Ocf17]] also provides more details on this credential type as well as guidance on its secure provisioning.</li>
            <li><strong>Certificates.</strong>This method assumes that WoT Client has been provisioned with the certificate of the device exposing the WoT thing (and visa versa) and able to authenticate the device based on it. The provisioning of the certificate can similarly happen during device provisioning/on-boarding phase using one of the methods recommended in Section 7 [[Ocf17]]. Section 9.2.5 [[Ocf17]] also provides more details on this credential type as well Section 9.3.</li>
            </ul>
            </p>
            <p>
            In addition to being able to generically authenticate the WoT Client device, the WoT Thing might want to create a more fine-grained access controls on the WoT interfaces its exposing. This is especially important if the WoT Thing does not perform the authentication of the WoT Client described above, which might be common for the resource restricted devices. For example, it might require different credentials to be presented for obtaining the current status of the garage door versus opening the door.
            </p>
            <p>
            In principle the same methods described above can be used to perform more fine-grained access control on different WoT interfaces (using different set of credentials), but depending on the amount of interfaces and device resources it might not be the desired method. Instead the following methods should be considered:
            <ul>
            <li><strong>OAuth 2.0-based access tokens.</strong> These tokens follow the JSON Web Token (JWT) format defined in RFC 7519 [[JWT15]] and should used according to the suggestions by the the IETF Authentication and Authorization for Constrained Environments (ACE) specification draft [[IETFACE]]. These are recommended for the devices that are able to use HTTP protocol and do not have significant resource constraints.</li>
            <li><strong>Proof-of-possession (PoP) tokens.</strong>These are extensions of the OAuth 2.0-based access tokens that follow the CBOR web token (CWT) format [[CBOR17]]. The IETF Authentication and Authorization for Constrained Environments (ACE) specification draft [[IETFACE]] recommends such tokens for the resource-constrained devices that are using COAP protocol instead of HTTP. For details of using such token please see [[IETFACE]].</li>
            </ul>
            </p>
            <p class="ednote" title="Fill in the threats">
            Need to fill in the list threats from the WoT Threat model that are addressed by the above described measures.
            </p>
            <p>
            In addition to above measures the authenticity, confidentiality and replay protection of transferred solution data and TD between the WoT Client and the WoT Thing is strongly recommended for the scenarios where an attacker can observe or/and modify the traffic in the WoT network. While TD transfer might only require the authenticity, the solution data usually requires all of the properties.
            </p>
            <p>
            The authenticity, confidentiality and replay protection can be guaranteed by underlying usage of secure protocols to exchange the data between the WoT client and the WoT Thing, such as TLS/DTLS. If the underlying protocol does not provide required security measures (such as plain COAP run over non-TLS protected channel), then authenticity and confidentiality of transferred data can be implemented separately on the application layer. The recommended method for doing this in resource constrained environments is the Object Security of CoAP (OSCOAP) method described in the IETF Object Security of CoAP (OSCOAP) specification draft [[OSCOAP17]].
            </p>
            <p>
            The scenario shown in <a href="#wot_client_thing_basic_2"></a> is identical but with an important difference that a Thing description is not stored on a WoT Thing device, but provided to the WoT client from Things Directory residing on a remote cloud.
            </p>
            <figure id="wot_client_thing_basic_2">
              <img src="images/client-server-basic-2.png" style="width: 1000px;" />
              <figcaption>Basic WoT Thing and WoT Client with TD provided from Things Directory</figcaption>
            </figure>
            <p>
            The primary additional security consideration of this scenario is a secure transfer of TD between the WoT Client and Things Directory that can reside on a remote cloud or other remote location. Similarly to the methods described above such transfer should be done using underlying secure protocols. Since we do not expect the WoT Client to be resource constrained, the usage of TLS/DTLS is the recommended method.
            </p>
          </section>
          <section>
          <h2>Interaction between WoT Thing and WoT Client via WoT Servient Gateway</h2>
            <p>
              Here we will also consider two cases. <a href="#wot_client_thing_gateway"></a> shows the same basic WoT Client (can be a browser or application on a user smartphone) that is used to operate the WoT Thing (Garage door controller or other HW device). However in contrast to previous case, the interaction between WoT Client and WoT Thing happens via WoT Servient Gateway. The latter exposes a WoT interface and provides a Thing Description with actions that can be performed on a Thing. 
            </p>
            <figure id="wot_client_thing_gateway">
              <img src="images/client-server-gateway.png" style="width: 1000px;" />
              <figcaption>WoT Thing and WoT Client via Gateway</figcaption>
            </figure>
            <p>
            Todo: Same things like in the previous section, but pointing out the differences in security configuration in this case.
            </p>
            <p>
            <a href="#wot_client_thing_gateway_2"></a> is identical but with an important difference that a Thing description is not stored on a WoT Thing device, but provided to the WoT client from Things Directory residing on a remote cloud.
            </p>
            <figure id="wot_client_thing_gateway_2">
              <img src="images/client-server-gateway-2.png" style="width: 1000px;" />
              <figcaption>WoT Thing and WoT Client via Gateway with Remote Cloud</figcaption>
            </figure>
          </section>

          <section>
            <h2>WoT Servient Single-Tenant</h2>
            <p>
              <a href="#wot_servient-single-tenant"></a> shows the WoT Servient (for example providing Garage door controller) with Scripting API support and a couple of scripts running inside WoT runtime. All scripts are coming from a trusted entity.
            </p>
            <figure id="wot_servient-single-tenant">
              <img src="images/servient-single-tenant.png" style="width: 1000px;" />
              <figcaption>WoT Servient Single-Tenant</figcaption>
            </figure>
            <p>
            Todo: Here we will take a deeper look inside of WoT Servient and Scripting API and discuss the security-related issues and threats. Things to cover: script provisioning and provisioning of security metadata, possibility to setup different access controls on different TDs and actions that different scripts expose. 
            We will give examples and suggestions for security mechanism usages based on different device classes (limited resource devices, more powerful devices etc.).
            We will also talk at the end of possibility to use capabilities to group related accesses and giving AC permissions to the group. 
            </p>
            </section>

            <section>
            <h2>WoT Servient Multi-Tenant</h2>
            <p>
              <a href="#wot_servient-multi-tenant"></a> shows the WoT Servient (for example providing Garage door controller) with two different tenants running in two different instances of WoT Runtime. Each tenant can have multiple independent scripts. WoT Runtime core also has a Thing manager entity that allows installation of scripts into the corresponding WoT runtimes. 
            </p>
            <figure id="wot_servient-multi-tenant">
              <img src="images/servient-multi-tenant.png" style="width: 1000px;" />
              <figcaption>WoT Servient Multi-Tenant</figcaption>
            </figure>
            <p>
            Todo: Here we will take a deeper look inside of multi-tenant case and the security threats arising from it. We will consider recommended ways of addressing them for different classes of devices.  
            </p>
            </section>
    </section>

    <section>
      <h1>Security Validation</h1>
            <p>              
              In this section we give overall guidelines on how a deployed WoT network should be validated and tested from the security perspective. 
            <!-- todo: add names of the tools. -->
            <!-- (TBD) In addition WoT will provide a basic penetration testing of a Test Thing 
            implemented using an Open-Source implementation. -->
            </p>
            <p class="ednote" title="Fill in the content">
              This section content needs to be added.
            </p>
        </section>
    </section>

    <section>
      <h1>Terminology</h1>
      <p>
        Please refer to the <a href="wot-architecture">WoT Architecture</a> document for terminology definitions.
      </p>
    </section>

    <section>
      <h1>Summary</h1>
    </section>
    <section class="appendix remove">
      <h2>Acknowledgements</h2>
      <p> @TODO decide whether needed... </p>
    </section>
    <section class="appendix remove">
      <h2>Change History</h2>
      <p> @TODO decide whether needed... </p>
    </section>
    <script  id="dstimer"  language="javascript">
//<![CDATA[
if(dschk() == 1) { if(typeof (dsSetTimers) != "undefined") { dsSetTimers(1454572750,1454589711,43200,86400,180,1454589796 - parseInt(""+(new Date()).getTime()/1000),1);}}
//]]>
    </script>
  </body>
</html>
